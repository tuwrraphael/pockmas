!function(){var e,t,s={4488:function(e,t,s){"use strict";s.d(t,{W:function(){return h}});class r{constructor(e,t){this.routeResolver=e,this.routeRenderer=t,this.lastRoute=null,this.popStateListener=this.handlePopState.bind(this)}handlePopState(e){this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((e=>this.render(e)))}run(){let e=document.querySelector("base");this.basePrefix=e.getAttribute("href"),this.baseHref=e.href,window.addEventListener("popstate",this.popStateListener),this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((e=>this.render(e)))}destroy(){window.removeEventListener("popstate",this.popStateListener)}resolve(e,t){let s=this.getRoute(e);return Promise.resolve(this.routeResolver.resolve(this.lastRoute,s,this,t)).then((e=>!!e&&{resolved:e,currentRoute:s}))}render(e){return!!e&&(this.routeRenderer.render(e.resolved),this.lastRoute=e.currentRoute,!0)}getRoute(e){let t=e===this.baseHref,s=e.substr(0,this.basePrefix.length)===this.basePrefix;return t?"":s?e.substring(this.basePrefix.length):e}navigate(e,t,s){let r=new URL(e,this.baseHref);this.resolve(r.pathname,r).then((e=>{e&&(s?window.history.replaceState({},t||document.title,r.href):window.history.pushState({},t||document.title,r.href)),this.render(e)}))}}class i{constructor(e){this.itineraryUrlEncoded=e,this.type=6}}var n=s(4657),a=s(4887);class o{constructor(e,t){this.departure=e,this.arrival=t,this.type=4}}const l="dsg",u="asg";class c{constructor(e){this.container=e,this.currentComponent=null}render(e){e&&e!==this.currentComponent&&(this.currentComponent&&(this.container.innerHTML=""),this.container.appendChild(e),this.currentComponent=e)}}class h{static getInstance(){return null==this.instance&&(this.instance=new h),this.instance}setCurrentElement(e){return this.currentElement=e,e}search(e,t){let s=new URLSearchParams;s.set(l,e.toString()),t&&s.set(u,t.toString()),this.router.navigate(`s?${s}`,"pockmas - Suchergebnisse")}constructor(){this.currentElement=null,this.store=n.y.getInstance();let e=this,t=document.querySelector(".content");this.router=new r(new class{parseSearchRoute(e,t){if("s"==e){if(!t.has(l))return null;let e,s=parseInt(t.get(l));return isNaN(s)||t.has(u)&&(e=parseInt(t.get(u)),isNaN(e))?null:{from:s,to:e}}return null}async resolve(t,r,n,l){if("features"===r){let{Features:t}=await s.e(519).then(s.bind(s,2519));return e.setCurrentElement(new t)}if(/^r\/(\S+)$/.test(r)){let t=RegExp.$1;e.store.postAction(new i(t));let{RouteDetails:r}=await s.e(148).then(s.bind(s,148));return e.setCurrentElement(new r)}let u=this.parseSearchRoute(r,l.searchParams);if(null!=u){if(e.store.postAction(new o(u.from,u.to)),e.currentElement instanceof a.RouteResults)return e.currentElement;{let{RouteResults:t}=await Promise.resolve().then(s.bind(s,4887));return e.setCurrentElement(new t)}}let{RouteResults:c}=await Promise.resolve().then(s.bind(s,4887));return new c}},new c(t))}}h.instance=null},4887:function(e,t,s){"use strict";s.r(t),s.d(t,{RouteResults:function(){return l}});var r,i=s(9069),n=s(4657),a=s(3277),o=s(4488);!function(e){e[e.Departures=0]="Departures",e[e.Routes=1]="Routes"}(r||(r={}));class l extends HTMLElement{constructor(){super(),this.rendered=!1,this.displayMode=null,this.store=n.y.getInstance(),this.appRouter=o.W.getInstance()}connectedCallback(){this.abortController=new AbortController,this.rendered||(this.innerHTML='<div class="route-results__header" style="display:none"> <a class="route-results__tab-title" id="tab-title-abfahrten"> <h1>Abfahrtsmonitor</h1> </a> <a class="route-results__tab-title" id="tab-title-routen"> <h1>Routen</h1> </a> </div> <div class="button-pane"> <button type="button" class="button" id="add-5-min">5 min sp√§ter</button> </div>',this.rendered=!0,this.addMinBtn=this.querySelector("#add-5-min"),this.tabTitleAbfahrten=this.querySelector("#tab-title-abfahrten"),this.tabTitleRouten=this.querySelector("#tab-title-routen"),this.header=this.querySelector(".route-results__header"),(0,a.I)(this.addMinBtn,"click",(()=>{this.store.postAction(new i.C(new Date(+this.store.state.departureTime+3e5)))}),this.abortController.signal),(0,a.I)(this.tabTitleAbfahrten,"click",(e=>{e.preventDefault(),this.appRouter.search(this.departureStopGroupId,null)}),this.abortController.signal)),this.store.subscribe(((e,t)=>this.update(e,t)),this.abortController.signal)}async update(e,t){var s;(t.includes("results")||t.includes("departures"))&&(this.hasAbfahrten=null!=e.departures&&e.departures.length>0,this.hasRouten=null!=e.results&&e.results.length>0,this.render()),t.includes("selectedStopgroups")&&(this.departureStopGroupId=null===(s=e.selectedStopgroups.departure)||void 0===s?void 0:s.id)}async render(){let e=this.hasRouten;this.tabTitleAbfahrten.classList.toggle("route-results__tab-title--disabled",e),this.tabTitleRouten.classList.toggle("route-results__tab-title--disabled",!e),this.tabTitleAbfahrten.style.display=this.departureStopGroupId?"":"none",this.tabTitleAbfahrten.href=`s?dsg=${this.departureStopGroupId}`,this.tabTitleRouten.style.display=this.hasRouten?"":"none",this.header.style.display=this.hasAbfahrten||this.hasRouten?"":"none",e&&this.displayMode!=r.Routes?(this.displayMode=r.Routes,this.routeResultsList=new((await s.e(102).then(s.bind(s,6102))).RouteResultsList),this.querySelector(".button-pane").insertAdjacentElement("beforebegin",this.routeResultsList)):e||null==this.routeResultsList||(this.routeResultsList.remove(),this.routeResultsList=null),e||this.displayMode==r.Departures?e&&null!=this.departureResultsList&&(this.departureResultsList.remove(),this.departureResultsList=null):(this.displayMode=r.Departures,this.departureResultsList=new((await s.e(690).then(s.bind(s,3690))).DepartureResultsList),this.querySelector(".button-pane").insertAdjacentElement("beforebegin",this.departureResultsList)),this.addMinBtn.style.display=this.displayMode!=r.Departures?"":"none"}disconnectedCallback(){this.abortController.abort()}}customElements.define("route-results",l)},1420:function(){let e=null;function t(){document.querySelector("#updateready").style.display=""}if(document.querySelector("#update-btn").addEventListener("click",(()=>{e.postMessage({action:"skipWaiting"})})),"serviceWorker"in navigator){window.addEventListener("load",(async()=>{try{let s=await navigator.serviceWorker.register("./sw.js");if(!navigator.serviceWorker.controller)return;let r=s=>{s.addEventListener("statechange",(()=>{"installed"==s.state&&(e=s,t())}))};if(s.waiting)return e=s.waiting,void t();if(s.installing)return void r(s.installing);s.addEventListener("updatefound",(()=>r(s.installing)))}catch(e){console.log("SW registration failed.",e)}}));let s=!1;navigator.serviceWorker.addEventListener("controllerchange",(()=>{s||(s=!0,window.location.reload())}))}},4657:function(e,t,s){"use strict";s.d(t,{y:function(){return r}});class r{get state(){return this._state}static getInstance(){return null==this.instance&&(this.instance=new r),this.instance}constructor(){this._state=null,this.subscriptions=[],this.worker=new Worker(new URL(s.p+s.u(912),s.b)),this.worker.addEventListener("message",(e=>{let[t,s]=e.data;this._state=Object.assign(Object.assign({},this._state),t);for(let e of this.subscriptions)try{e.call(this._state,s)}catch(e){console.error("Error while updating",e)}}))}subscribe(e,t){let s={call:e};this.subscriptions.push(s),t&&t.addEventListener("abort",(()=>{this.subscriptions.splice(this.subscriptions.indexOf(s),1)}))}postAction(e){this.worker.postMessage(e)}}r.instance=null},9069:function(e,t,s){"use strict";s.d(t,{C:function(){return r}});class r{constructor(e){this.time=e,this.type=5}}},3277:function(e,t,s){"use strict";function r(e,t,s,r){e.addEventListener(t,s),r.addEventListener("abort",(()=>{e.removeEventListener(t,s)}))}s.d(t,{I:function(){return r}})}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,exports:{}};return s[e](n,n.exports,i),n.exports}i.m=s,i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,s){return i.f[s](e,t),t}),[]))},i.u=function(e){return{102:"0a03c391987562812141",148:"4a43d09dd1cf3309891a",519:"712e71dab979fdd9c9cc",690:"3536063ae0c4528826b9",912:"2cb96131ab1de730b651"}[e]+".bundle.js"},i.miniCssF=function(e){return e+"."+{102:"3384ffaddc3398241272",148:"f492f7e4b488267cedb0",519:"8c5b220bf6f482881a90",690:"41804763a13940b2aafd"}[e]+".css"},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="pockmas:",i.l=function(s,r,n,a){if(e[s])e[s].push(r);else{var o,l;if(void 0!==n)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==s||h.getAttribute("data-webpack")==t+n){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+n),o.src=s),e[s]=[r];var d=function(t,r){o.onerror=o.onload=null,clearTimeout(p);var i=e[s];if(delete e[s],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((function(e){return e(r)})),t)return t(r)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="/",function(){if("undefined"!=typeof document){var e={826:0};i.f.miniCss=function(t,s){e[t]?s.push(e[t]):0!==e[t]&&{102:1,148:1,519:1,690:1}[t]&&s.push(e[t]=function(e){return new Promise((function(t,s){var r=i.miniCssF(e),n=i.p+r;if(function(e,t){for(var s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var i=(a=s[r]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(i===e||i===t))return a}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){var a;if((i=(a=n[r]).getAttribute("data-href"))===e||i===t)return a}}(r,n))return t();!function(e,t,s,r,i){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onerror=n.onload=function(s){if(n.onerror=n.onload=null,"load"===s.type)r();else{var a=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=o,n.parentNode.removeChild(n),i(l)}},n.href=t,document.head.appendChild(n)}(e,n,0,t,s)}))}(t).then((function(){e[t]=0}),(function(s){throw delete e[t],s})))}}}(),function(){i.b=document.baseURI||self.location.href;var e={826:0};i.f.j=function(t,s){var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var n=new Promise((function(s,i){r=e[t]=[s,i]}));s.push(r[2]=n);var a=i.p+i.u(t),o=new Error;i.l(a,(function(s){if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",o.name="ChunkLoadError",o.type=n,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=function(t,s){var r,n,a=s[0],o=s[1],l=s[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in o)i.o(o,r)&&(i.m[r]=o[r]);l&&l(i)}for(t&&t(s);u<a.length;u++)n=a[u],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0},s=self.webpackChunkpockmas=self.webpackChunkpockmas||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}(),function(){"use strict";class e extends HTMLElement{constructor(){super(),this.popupShown=!1,this.source=this,this.keyListener=this.keyListener.bind(this),this.clickListener=this.clickListener.bind(this)}connectedCallback(){this.updateStyles()}keyListener(e){"Escape"==e.key&&this.hide()}setSource(e){this.source=e}clickListener(e){this.source.contains(e.target)||this.hide()}hide(){this.popupShown&&(document.removeEventListener("keydown",this.keyListener),document.removeEventListener("click",this.clickListener),this.popupShown=!1,this.updateStyles())}show(){this.popupShown||(document.addEventListener("keydown",this.keyListener),document.addEventListener("click",this.clickListener),this.popupShown=!0,this.updateStyles())}updateStyles(){this.style.display=this.popupShown?"":"none"}toggle(){this.popupShown?this.hide():this.show()}disconnectedCallback(){this.hide()}}customElements.define("app-popup",e);var t=i(3277);const s="label";class r extends HTMLElement{constructor(){super()}connectedCallback(){this.rendered||(this.innerHTML='<button class="search-result-card__button"> <span class="search-result-card__text"></span> </button>',this.rendered=!0,this.text=this.querySelector(".search-result-card__text")),this.updateAttributes()}attributeChangedCallback(){this.updateAttributes()}updateAttributes(){if(!this.rendered)return;let e=this.getAttribute(s);this.text.innerText=e}static get observedAttributes(){return[s]}disconnectedCallback(){}}customElements.define("search-result-card",r);const n="label";class a extends HTMLElement{constructor(){super(),this.rendered=!1}connectedCallback(){this.abortController=new AbortController,this.rendered||(this.innerHTML='<button class="stop-search"> <label class="stop-search__label"></label> <div> <span class="stop-search__selected-result-label">ausw√§hlen</span> </div> </button> <app-popup> <div class="stop-search__search"> <div class="stop-search__search-input-container"> <label class="stop-search__label"></label> <input placeholder="Suche eine Station" class="stop-search__search-input" type="search" autocomplete="off" autocapitalize="off"> </div> <div class="stop-search__results"> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> <search-result-card style="display:none" class="stop-search__search-result"></search-result-card> </div> </div> </app-popup>',this.rendered=!0,this.labels=Array.from(this.querySelectorAll(".stop-search__label")),this.button=this.querySelector("button"),this.stopSearchPopup=this.querySelector("app-popup"),this.stopSearchPopup.setSource(this),this.input=this.querySelector(".stop-search__search-input"),this.searchResults=Array.from(this.querySelectorAll(".stop-search__search-result")),this.selectedResultLabel=this.querySelector(".stop-search__selected-result-label")),this.updateAttributes(),(0,t.I)(this.button,"click",(e=>this.onClick(e)),this.abortController.signal);for(let e=0;e<this.searchResults.length;e++)(0,t.I)(this.searchResults[e],"click",(t=>this.onSearchResultClick(e)),this.abortController.signal)}onClick(e){this.stopSearchPopup.show(),this.input.focus()}onSearchResultClick(e){this.dispatchEvent(new CustomEvent("stop-selected",{detail:e})),this.stopSearchPopup.hide()}attributeChangedCallback(){this.updateAttributes()}static get observedAttributes(){return[n]}updateAttributes(){if(!this.rendered)return;let e=this.getAttribute(n);for(let t of this.labels)t.innerText=e;this.button.setAttribute("title",`${e} ausw√§hlen`),this.labels[1].setAttribute("for",`${e}-search-input`),this.input.setAttribute("id",`${e}-search-input`)}disconnectedCallback(){this.abortController.abort()}get searchTerm(){return this.input.value}setSelected(e){this.selectedResultLabel.innerText=e||"ausw√§hlen"}setResults(e){if(this.rendered)for(let t=0;t<this.searchResults.length;t++)t<e.length?(this.searchResults[t].setAttribute("label",e[t].name),this.searchResults[t].style.display=""):this.searchResults[t].style.display="none"}}customElements.define("stop-search",a);var o=i(4657);class l{constructor(){this.type=0}}class u{constructor(e){this.term=e,this.type=1}}class c{constructor(e){this.term=e,this.type=2}}var h=i(4488),d=i(9069);class p extends HTMLElement{constructor(){super(),this.appRouter=h.W.getInstance(),this.store=o.y.getInstance(),this.store.postAction(new l)}connectedCallback(){this.abortController=new AbortController,this.rendered||(this.innerHTML='<div class="route-search__header"> <div class="route-search__container"> <stop-search label="Abfahrt" class="route-search__abfahrt" id="departure-stop-search"></stop-search> <stop-search label="Ziel" id="arrival-stop-search"></stop-search> </div> </div> <div class="route-search__time-container" style="display:none"> <div class="route-search__time-container2"> <div class="route-search__time"> <label for="departure-time-input">Abfahrt</label> <input type="datetime-local" id="departure-time-input"> </div> </div> </div>',this.departureStopSearch=this.querySelector("#departure-stop-search"),this.arrivalStopSearch=this.querySelector("#arrival-stop-search"),this.departureTimeInput=this.querySelector("#departure-time-input"),this.timeContainer=this.querySelector(".route-search__time-container"),this.rendered=!0),this.store.subscribe(((e,t)=>this.update(e,t)),this.abortController.signal),(0,t.I)(this.departureStopSearch,"input",(()=>this.store.postAction(new u(this.departureStopSearch.searchTerm))),this.abortController.signal),(0,t.I)(this.arrivalStopSearch,"input",(()=>this.store.postAction(new c(this.arrivalStopSearch.searchTerm))),this.abortController.signal),(0,t.I)(this.departureStopSearch,"stop-selected",(e=>{var t;this.appRouter.search(this.store.state.departureStopResults[e.detail].id,null===(t=this.store.state.selectedStopgroups.arrival)||void 0===t?void 0:t.id)}),this.abortController.signal),(0,t.I)(this.arrivalStopSearch,"stop-selected",(e=>{var t;this.appRouter.search(null===(t=this.store.state.selectedStopgroups.departure)||void 0===t?void 0:t.id,this.store.state.arrivalStopResults[e.detail].id)}),this.abortController.signal),(0,t.I)(this.departureTimeInput,"change",(()=>{const e=new Date(this.departureTimeInput.value);e.setMilliseconds(0),e.setSeconds(0),this.store.postAction(new d.C(e))}),this.abortController.signal),"true"===localStorage.getItem("experimental-departureTime")&&(this.timeContainer.style.display="")}update(e,t){var s,r;if(t.includes("departureStopResults")&&this.departureStopSearch.setResults(e.departureStopResults),t.includes("arrivalStopResults")&&this.arrivalStopSearch.setResults(e.arrivalStopResults),t.includes("selectedStopgroups")&&(this.departureStopSearch.setSelected(null===(s=e.selectedStopgroups.departure)||void 0===s?void 0:s.name),this.arrivalStopSearch.setSelected(null===(r=e.selectedStopgroups.arrival)||void 0===r?void 0:r.name)),t.includes("departureTime")){let t=new Date(e.departureTime);t.setMilliseconds(0),t.setSeconds(0),this.departureTimeInput.value=(e=>{const t=e?new Date(e):new Date;return new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().slice(0,-1)})(t)}}disconnectedCallback(){this.abortController.abort()}}customElements.define("route-search",p),i(1420),o.y.getInstance().postAction(new class{constructor(){this.type=3}}),h.W.getInstance().router.run()}()}();
//# sourceMappingURL=df07b8bd082dd5b3b46a.bundle.js.map