"use strict";(self.webpackChunkpockmas=self.webpackChunkpockmas||[]).push([[274],{3690:function(e,t,s){s.r(t),s.d(t,{DepartureResultsList:function(){return o}}),s(6699);class r{constructor(){this.type=7}}var i=s(4657),n=s(6029);s(2208),s(4203);class d extends HTMLElement{constructor(){super(),this.rendered=!1}connectedCallback(){this.abortController=new AbortController,this.rendered||(this.innerHTML="<departure-display></departure-display>",this.rendered=!0,this.departureDisplay=this.querySelector("departure-display")),this.render()}render(){this.rendered&&this.departure&&this.departureDisplay.update(this.departure)}update(e){this.departure=e,this.render()}disconnectedCallback(){this.abortController.abort()}}customElements.define("departure-summary",d);class o extends HTMLElement{constructor(){super(),this.rendered=!1,this.departures=[],this.moreRequestedAt=0,this.lastSelectedDest=null,this.store=i.y.getInstance()}requestMoreDepartures(){this.store.postAction(new r)}connectedCallback(){this.abortController=new AbortController,this.intersectionObserver=new IntersectionObserver((e=>{if(e.some((e=>e.isIntersecting))){if(this.moreRequestedAt>=this.departures.length)return;this.requestMoreDepartures(),this.moreRequestedAt=this.departures.length}}),{root:null,threshold:1}),this.rendered||(this.innerHTML="",this.rendered=!0,this.renderer=new n.T(this,(e=>this.departures.indexOf(e)),(e=>new d))),this.store.subscribe(((e,t)=>this.update(e,t)),this.abortController.signal),this.init(this.store.state)}setResults(e){(null==e?void 0:e.departures)&&(this.departures=e.departures,this.renderer.update(this.departures,((e,t)=>{e.update(t)})),this.intersectionObserver.disconnect(),this.lastElementChild&&this.intersectionObserver.observe(this.lastElementChild))}update(e,t){var s,r;t.includes("departures")&&this.setResults(e),t.includes("selectedStopgroups")&&(null===(s=e.selectedStopgroups.departure)||void 0===s?void 0:s.id)!=this.lastSelectedDest&&(this.lastSelectedDest=null===(r=e.selectedStopgroups.departure)||void 0===r?void 0:r.id,this.moreRequestedAt=0)}init(e){this.setResults(e)}disconnectedCallback(){this.abortController.abort(),this.intersectionObserver.disconnect()}}customElements.define("departure-results-list",o)}}]);
//# sourceMappingURL=84b8eb1addeafebf6d60.bundle.js.map